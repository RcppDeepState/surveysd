<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to surveysd â€¢ surveysd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to surveysd">
<meta property="og:description" content="surveysd">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveysd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/surveysd.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/error_estimation.html">Error estimation</a>
    </li>
    <li>
      <a href="../articles/ipf.html">Iterative Proportional Fitting</a>
    </li>
    <li>
      <a href="../articles/methodology.html">Methodology</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statistikat/surveysd/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to surveysd</h1>
            
            <h4 class="date">2020-07-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/statistikat/surveysd/blob/master/vignettes/surveysd.Rmd"><code>vignettes/surveysd.Rmd</code></a></small>
      <div class="hidden name"><code>surveysd.Rmd</code></div>

    </div>

    
    
<p>The goal of surveysd is to combine all necessary steps to use calibrated bootstrapping with custom estimation functions. This vignette will cover the usage of the most important functions. For insights in the theory used in this package, refer to <code><a href="../articles/methodology.html">vignette("methodology")</a></code>.</p>
<div id="load-dummy-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-dummy-data" class="anchor"></a>Load dummy data</h3>
<p>A test data set based on <code><a href="https://rdrr.io/r/utils/data.html">data(eusilc, package = "laeken")</a></code> can be created with <code><a href="../reference/demo.eusilc.html">demo.eusilc()</a></code></p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/statistikat/surveysd">surveysd</a></span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1234</span>)
<span class="kw">eusilc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demo.eusilc.html">demo.eusilc</a></span>(n = <span class="fl">2</span>, prettyNames = <span class="fl">TRUE</span>)

<span class="kw">eusilc</span>[<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">.</span>(<span class="kw">year</span>, <span class="kw">povertyRisk</span>, <span class="kw">gender</span>, <span class="kw">pWeight</span>)]
</pre></div>
<pre><code>##    year povertyRisk gender  pWeight
## 1: 2010       FALSE female 504.5696
## 2: 2010       FALSE   male 504.5696
## 3: 2010       FALSE   male 504.5696
## 4: 2010       FALSE female 493.3824
## 5: 2010       FALSE   male 493.3824</code></pre>
</div>
<div id="draw-bootstrap-replicates" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-bootstrap-replicates" class="anchor"></a>Draw bootstrap replicates</h3>
<p>Use stratified resampling without replacement to generate 10 samples. Those samples are consistent with respect to the reference periods.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">dat_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw.bootstrap.html">draw.bootstrap</a></span>(<span class="kw">eusilc</span>, REP = <span class="fl">10</span>, hid = <span class="st">"hid"</span>, weights = <span class="st">"pWeight"</span>, 
                           strata = <span class="st">"region"</span>, period = <span class="st">"year"</span>)
</pre></div>
</div>
<div id="calibrate-bootstrap-replicates" class="section level3">
<h3 class="hasAnchor">
<a href="#calibrate-bootstrap-replicates" class="anchor"></a>Calibrate bootstrap replicates</h3>
<p>Calibrate each sample according to the distribution of <code>gender</code> (on a personal level) and <code>region</code> (on a household level).</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">dat_boot_calib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recalib.html">recalib</a></span>(<span class="kw">dat_boot</span>, conP.var = <span class="st">"gender"</span>, conH.var = <span class="st">"region"</span>,
                          epsP = <span class="fl">1e-2</span>, epsH = <span class="fl">2.5e-2</span>, verbose = <span class="fl">TRUE</span>)
</pre></div>
<pre><code>## Iteration stopped after 3 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 3 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 2 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 2 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 3 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 3 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 2 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 3 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 2 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<pre><code>## Iteration stopped after 2 steps</code></pre>
<pre><code>## Convergence reached</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="kw">dat_boot_calib</span>[<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">.</span>(<span class="kw">year</span>, <span class="kw">povertyRisk</span>, <span class="kw">gender</span>, <span class="kw">pWeight</span>, <span class="kw">w1</span>, <span class="kw">w2</span>, <span class="kw">w3</span>, <span class="kw">w4</span>)]
</pre></div>
<pre><code>##    year povertyRisk gender  pWeight       w1        w2        w3        w4
## 1: 2010       FALSE female 504.5696 1025.360 0.4581938 0.4456302 0.4520549
## 2: 2010       FALSE   male 504.5696 1025.360 0.4581938 0.4456302 0.4520549
## 3: 2010       FALSE   male 504.5696 1025.360 0.4581938 0.4456302 0.4520549
## 4: 2011       FALSE female 504.5696 1024.862 0.4721126 0.4582807 0.4608312
## 5: 2011       FALSE   male 504.5696 1024.862 0.4721126 0.4582807 0.4608312</code></pre>
</div>
<div id="estimate-with-respect-to-a-grouping-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-with-respect-to-a-grouping-variable" class="anchor"></a>Estimate with respect to a grouping variable</h3>
<p>Estimate relative amount of persons at risk of poverty per period and <code>gender</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="kw">err.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span>(<span class="kw">dat_boot_calib</span>, var = <span class="st">"povertyRisk"</span>, fun = <span class="kw">weightedRatio</span>, group = <span class="st">"gender"</span>)
<span class="kw">err.est</span><span class="op">$</span><span class="kw">Estimates</span>
</pre></div>
<pre><code>##    year     n       N gender val_povertyRisk stE_povertyRisk
## 1: 2010  7267 3979572   male        12.02660       0.5882841
## 2: 2010  7560 4202650 female        16.73351       0.7473909
## 3: 2010 14827 8182222   &lt;NA&gt;        14.44422       0.6626295
## 4: 2011  7267 3979572   male        12.81921       0.6059190
## 5: 2011  7560 4202650 female        16.62488       0.7355060
## 6: 2011 14827 8182222   &lt;NA&gt;        14.77393       0.6631967</code></pre>
<p>The output contains estimates (<code>val_povertyRisk</code>) as well as standard errors (<code>stE_povertyRisk</code>) measured in percent. The rows with <code>gender = NA</code> denotes the aggregate over all genders for the corresponding year.</p>
</div>
<div id="estimate-with-respect-to-several-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-with-respect-to-several-variables" class="anchor"></a>Estimate with respect to several variables</h3>
<p>Estimate relative amount of persons at risk of poverty per period for each <code>region</code>, <code>gender</code>, and combination of both.</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="kw">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"gender"</span>, <span class="st">"region"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gender"</span>, <span class="st">"region"</span>))
<span class="kw">err.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span>(<span class="kw">dat_boot_calib</span>, var = <span class="st">"povertyRisk"</span>, fun = <span class="kw">weightedRatio</span>, group = <span class="kw">group</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">err.est</span><span class="op">$</span><span class="kw">Estimates</span>)
</pre></div>
<pre><code>##    year   n        N gender     region val_povertyRisk stE_povertyRisk
## 1: 2010 261 122741.8   male Burgenland       17.414524        3.831697
## 2: 2010 288 137822.2 female Burgenland       21.432598        3.243412
## 3: 2010 359 182732.9   male Vorarlberg       12.973259        1.869263
## 4: 2010 374 194622.1 female Vorarlberg       19.883637        3.112974
## 5: 2010 440 253143.7   male   Salzburg        9.156964        1.809600
## 6: 2010 484 282307.3 female   Salzburg       17.939382        2.587059</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="co">## skipping 54 more rows</span>
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Johannes Gussenbauer, Alexander Kowarik, Gregor de Cillia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
